{% extends 'base.html' %}

{% load static %}  <!-- Ensure this line is included at the top -->

{% block title %}{% if form.instance.id %}تعديل{% else %}إضافة{% endif %} بريد وارد{% endblock %}

{% block header %}{% if form.instance.id %} - تعديل{% else %} - إضافة{% endif %} بريد وارد{% endblock %}

{% block content %}
<div class="form-container">
    <form action="{% if form.instance.id %}{% url 'edit_incoming' form.instance.id %}{% else %}{% url 'add_incoming' %}{% endif %}" method="POST" enctype="multipart/form-data" dir="rtl">
        {% csrf_token %}
        
        <div class="input-group">
            <label for="orig_date">تاريخ الأصل:</label>
            {{ form.orig_date }}  <!-- This will render the DatePickerInput widget -->
        </div>

        <div class="input-group">
            <label for="date">تاريخ التسجيل:</label>
            {{ form.date }}  <!-- This will render the DatePickerInput widget -->
        </div>

        <div class="input-group">
            <label for="orig_number">رقم الأصل:</label>
            <input type="text" id="orig_number" name="orig_number" value="{{ form.orig_number.value|default:'' }}">
        </div>

        <div class="input-group">
            <label for="reg_number">رقم الرسالة:</label>
            <input type="text" id="reg_number" name="reg_number" value="{{ form.number.value|default:'' }}" required>
        </div>

        <div class="input-group">
            <label for="dept_from">من:</label>
            <input type="text" id="dept_from" name="dept_from" value="{{ form.dept_from.value|default:'' }}" required>
        </div>

        <div class="input-group">
            <label for="dept_to">إلى:</label>
            <input type="text" id="dept_to" name="dept_to" value="{{ form.dept_to.value|default:'' }}" required>
        </div>

        <div class="input-group">
            <label for="title">العنوان:</label>
            <input type="text" id="title" name="title" value="{{ form.title.value|default:'' }}" required>
        </div>

        <div class="input-group">
            <label for="keywords">الكلمات المفتاحية:</label>
            <textarea id="keywords" name="keywords" rows="4">{{ form.keywords.value|default:'' }}</textarea>
        </div>

        <div class="input-group">
            <span for="pdf_file" style="font-size: 20px; font-weight: 600;">ملف PDF:</span><br>
            <input type="file" id="pdf_file" name="pdf_file" accept="application/pdf" style="display: none;" onchange="renderPDF(), upFileName()">
            <label for="pdf_file" class="upload-label">اختر ملف</label>
            <span id="file-name">
                {% if form.instance.pdf_file %}
                    تنبيه! تم العثور على ملف PDF. سيتم استبداله في حالة اختيارك لملف جديد!
                {% else %}
                    لم يتم إختيار ملف.
                {% endif %}
            </span>
        </div>        

        <div class="button-group">
            <button type="submit" class="save-button">حفظ</button>
            <a href="{% url 'incoming_mail' %}" class="cancel-button">إلغاء</a>
        </div>
    </form>
    <div id="pdf-preview" class="pdf-preview-container2"></div> <!-- PDF Preview Container -->
</div>    
{% endblock %}